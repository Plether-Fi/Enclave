import Foundation

nonisolated enum Network: String, CaseIterable, Sendable {
    case arbitrumSepolia
    case arbitrumOne
    case anvil

    var chainId: UInt64 {
        switch self {
        case .arbitrumSepolia: 421614
        case .arbitrumOne, .anvil: 42161
        }
    }

    var rpcURL: URL {
        switch self {
        case .arbitrumSepolia:
            URL(string: "https://arb-sepolia.g.alchemy.com/v2/\(Secrets.alchemyAPIKey)")!
        case .arbitrumOne:
            URL(string: "https://arb-mainnet.g.alchemy.com/v2/\(Secrets.alchemyAPIKey)")!
        case .anvil:
            URL(string: "http://127.0.0.1:8584")!
        }
    }

    var bundlerURL: URL {
        switch self {
        case .arbitrumSepolia:
            URL(string: "https://arb-sepolia.g.alchemy.com/v2/\(Secrets.alchemyAPIKey)")!
        case .arbitrumOne:
            URL(string: "https://arb-mainnet.g.alchemy.com/v2/\(Secrets.alchemyAPIKey)")!
        case .anvil:
            URL(string: "http://127.0.0.1:3000")!
        }
    }

    var blockExplorerAPI: String {
        "https://api.etherscan.io/v2/api?chainid=\(chainId)"
    }

    var usdcAddress: String {
        switch self {
        case .arbitrumSepolia: "0x75faf114eafb1BDbe2F0316DF893fd58CE46AA4d"
        case .arbitrumOne, .anvil: "0xaf88d065e77c8cC2239327C5EDb3A432268e5831"
        }
    }

    var displayName: String {
        switch self {
        case .arbitrumSepolia: "Arbitrum Sepolia"
        case .arbitrumOne: "Arbitrum One"
        case .anvil: "Anvil (Local)"
        }
    }

    var isLocal: Bool { self == .anvil }

    var caip2: String { "eip155:\(chainId)" }
}

nonisolated enum Config {
    static let entryPointAddress = "0x0000000071727De22E5E9d8BAf0edAc6f37da032"
    static let factoryAddress = "0xff49fb5d47ccd009cd60b2b57839aa8887a8d979"

    static let gasPolicyId = "ff3e2c3f-3d8e-4046-959e-06fb0324cf2c"

    nonisolated(unsafe) static var activeNetwork: Network = .arbitrumSepolia

    static var ipfsGateways: [String] {
        if let custom = UserDefaults.standard.string(forKey: "ipfsNodeURL"), !custom.isEmpty {
            return [custom]
        }
        return [
            "https://ipfs.io/ipfs/",
            "https://cloudflare-ipfs.com/ipfs/",
            "https://dweb.link/ipfs/",
        ]
    }

    // EnclaveWallet creation bytecode (from `forge inspect EnclaveWallet bytecode`)
    // Used for offline CREATE2 address computation
    // swiftlint:disable:next line_length
    // swiftlint:disable:next line_length
    static let walletCreationCode = "60e060405234801561000f575f5ffd5b506040516120543803806120548339818101604052810190610031919061011f565b8273ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff16815250508160a081815250508060c0818152505050505061016f565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100aa82610081565b9050919050565b5f6100bb826100a0565b9050919050565b6100cb816100b1565b81146100d5575f5ffd5b50565b5f815190506100e6816100c2565b92915050565b5f819050919050565b6100fe816100ec565b8114610108575f5ffd5b50565b5f81519050610119816100f5565b92915050565b5f5f5f606084860312156101365761013561007d565b5b5f610143868287016100d8565b93505060206101548682870161010b565b92505060406101658682870161010b565b9150509250925092565b60805160a05160c051611ead6101a75f395f81816107e10152610cb001525f818161079d0152610c8f01525f6108060152611ead5ff3fe6080604052600436106100e0575f3560e01c8063b0d691fe1161007e578063b7b8d60411610058578063b7b8d604146102bd578063bf9890ab146102f9578063d087d28814610321578063f3f514151461034b576100e7565b8063b0d691fe14610243578063b20b216e1461026d578063b61d27f614610295576100e7565b806334fcd5be116100ba57806334fcd5be1461018b5780634edaff4e146101b35780639061a57f146101dd578063b004eab914610219576100e7565b80631626ba7e146100eb57806319822f7c146101275780632803212f14610163576100e7565b366100e757005b5f5ffd5b3480156100f6575f5ffd5b50610111600480360381019061010c9190611272565b610387565b60405161011e9190611309565b60405180910390f35b348015610132575f5ffd5b5061014d60048036038101906101489190611378565b610585565b60405161015a91906113f3565b60405180910390f35b34801561016e575f5ffd5b5061018960048036038101906101849190611466565b6105b7565b005b348015610196575f5ffd5b506101b160048036038101906101ac91906114f9565b61066b565b005b3480156101be575f5ffd5b506101c761079b565b6040516101d491906113f3565b60405180910390f35b3480156101e8575f5ffd5b5061020360048036038101906101fe9190611466565b6107bf565b60405161021091906113f3565b60405180910390f35b348015610224575f5ffd5b5061022d6107df565b60405161023a91906113f3565b60405180910390f35b34801561024e575f5ffd5b50610257610803565b604051610264919061159f565b60405180910390f35b348015610278575f5ffd5b50610293600480360381019061028e91906115b8565b61082a565b005b3480156102a0575f5ffd5b506102bb60048036038101906102b691906115e3565b6108ef565b005b3480156102c8575f5ffd5b506102e360048036038101906102de91906115b8565b610a9c565b6040516102f0919061166e565b60405180910390f35b348015610304575f5ffd5b5061031f600480360381019061031a91906115b8565b610ab8565b005b34801561032c575f5ffd5b50610335610b7c565b60405161034291906113f3565b60405180910390f35b348015610356575f5ffd5b50610371600480360381019061036c91906115b8565b610c03565b60405161037e91906113f3565b60405180910390f35b5f604183839050036104f5575f83835f906020926103a79392919061168f565b906103b291906116df565b90505f84846020906040926103c99392919061168f565b906103d491906116df565b90505f858560408181106103eb576103ea61173d565b5b9050013560f81c60f81b60f81c90505f6001888386866040515f815260200160405260405161041d9493929190611794565b6020604051602081039080840390855afa15801561043d573d5f5f3e3d5ffd5b5050506020604051035190505f73ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16141580156104ca57505f5f8273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff165b156104e257631626ba7e60e01b94505050505061057e565b63ffffffff60e01b94505050505061057e565b6040838390501461053b576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161053290611831565b60405180910390fd5b5f5f848481019061054c919061184f565b9150915061055b868383610c18565b1561057157631626ba7e60e01b9250505061057e565b63ffffffff60e01b925050505b9392505050565b5f61058e610e58565b6105988484610ee2565b90506105a78460200135610f86565b6105b082610f89565b9392505050565b3073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610625576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161061c906118d7565b60405180910390fd5b8060015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055505050565b610673610ffd565b5f8282905090505f5f90505b81811015610795573684848381811061069b5761069a61173d565b5b90506020028101906106ad9190611901565b90505f610722825f0160208101906106c591906115b8565b83602001358480604001906106da9190611928565b8080601f0160208091040260200160405190810160405280939291908181526020018383808284375f81840152601f19601f820116905080830192505050505050505a611007565b905080610786576001840361073e5761073961101e565b610785565b826107485f611031565b6040517f5a15467500000000000000000000000000000000000000000000000000000000815260040161077c9291906119fa565b60405180910390fd5b5b5050808060010191505061067f565b50505050565b7f000000000000000000000000000000000000000000000000000000000000000081565b6002602052815f5260405f20602052805f5260405f205f91509150505481565b7f000000000000000000000000000000000000000000000000000000000000000081565b5f7f0000000000000000000000000000000000000000000000000000000000000000905090565b3073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610898576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161088f906118d7565b60405180910390fd5b60015f5f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff02191690831515021790555050565b6108f7610e58565b5f83111561090a576109095f84611069565b5b60048282905010610a19575f82825f906004926109299392919061168f565b906109349190611a28565b905063a9059cbb60e01b817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614801561096f575060448383905010155b156109a8575f83836024906044926109899392919061168f565b8101906109969190611a86565b90506109a28682611069565b50610a17565b63095ea7b360e01b817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161480156109e1575060448383905010155b15610a16575f83836024906044926109fb9392919061168f565b810190610a089190611a86565b9050610a148682611069565b505b5b505b5f5f8573ffffffffffffffffffffffffffffffffffffffff16858585604051610a43929190611aed565b5f6040518083038185875af1925050503d805f8114610a7d576040519150601f19603f3d011682016040523d82523d5f602084013e610a82565b606091505b509150915081610a9457805160208201fd5b505050505050565b5f602052805f5260405f205f915054906101000a900460ff1681565b3073ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610b26576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b1d906118d7565b60405180910390fd5b5f5f5f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff02191690831515021790555050565b5f610b85610803565b73ffffffffffffffffffffffffffffffffffffffff166335567e1a305f6040518363ffffffff1660e01b8152600401610bbf929190611b70565b602060405180830381865afa158015610bda573d5f5f3e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610bfe9190611bab565b905090565b6001602052805f5260405f205f915090505481565b5f5f600285604051602001610c2d9190611bf6565b604051602081830303815290604052604051610c499190611c40565b602060405180830381855afa158015610c64573d5f5f3e3d5ffd5b5050506040513d601f19601f82011682018060405250810190610c879190611c6a565b90505f8185857f00000000000000000000000000000000000000000000000000000000000000007f0000000000000000000000000000000000000000000000000000000000000000604051602001610ce3959493929190611c95565b60405160208183030381529060405290505f5f61010073ffffffffffffffffffffffffffffffffffffffff1683604051610d1d9190611c40565b5f60405180830381855afa9150503d805f8114610d55576040519150601f19603f3d011682016040523d82523d5f602084013e610d5a565b606091505b5091509150818015610d6d575060208151145b8015610d8c5750600181806020019051810190610d8a9190611bab565b145b15610d9e576001945050505050610e51565b73c2b78104907f722dabac4c69f826a522b2754de473ffffffffffffffffffffffffffffffffffffffff1683604051610dd79190611c40565b5f60405180830381855afa9150503d805f8114610e0f576040519150601f19603f3d011682016040523d82523d5f602084013e610e14565b606091505b508092508193505050818015610e2b575060208151145b8015610e4a5750600181806020019051810190610e489190611bab565b145b9450505050505b9392505050565b610e60610803565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16143330610e98610803565b909192610edd576040517ffe34a6d3000000000000000000000000000000000000000000000000000000008152600401610ed493929190611ce6565b60405180910390fd5b505050565b5f604083806101000190610ef69190611928565b905014610f38576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610f2f90611831565b60405180910390fd5b5f5f84806101000190610f4b9190611928565b810190610f58919061184f565b915091505f610f68858484610c18565b905080610f76576001610f78565b5f5b60ff16935050505092915050565b50565b5f8114610ffa575f3373ffffffffffffffffffffffffffffffffffffffff1682604051610fb590611d3e565b5f6040518083038185875af1925050503d805f8114610fef576040519150601f19603f3d011682016040523d82523d5f602084013e610ff4565b606091505b50509050505b50565b611005610e58565b565b5f5f5f845160208601878987f19050949350505050565b61102f61102a5f611031565b6111b9565b565b60603d5f8311156110495782811115611048578290505b5b604051602082018101604052818152815f602083013e8092505050919050565b5f60015f8473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205490505f81036110b757506111b5565b5f6110c06111c1565b90505f8360025f8773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8481526020019081526020015f205461111b9190611d7f565b905082811115611160576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161115790611dfc565b60405180910390fd5b8060025f8773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8481526020019081526020015f20819055505050505b5050565b805160208201fd5b5f62015180426111d19190611e47565b905090565b5f5ffd5b5f5ffd5b5f819050919050565b6111f0816111de565b81146111fa575f5ffd5b50565b5f8135905061120b816111e7565b92915050565b5f5ffd5b5f5ffd5b5f5ffd5b5f5f83601f84011261123257611231611211565b5b8235905067ffffffffffffffff81111561124f5761124e611215565b5b60208301915083600182028301111561126b5761126a611219565b5b9250929050565b5f5f5f60408486031215611289576112886111d6565b5b5f611296868287016111fd565b935050602084013567ffffffffffffffff8111156112b7576112b66111da565b5b6112c38682870161121d565b92509250509250925092565b5f7fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b611303816112cf565b82525050565b5f60208201905061131c5f8301846112fa565b92915050565b5f5ffd5b5f610120828403121561133c5761133b611322565b5b81905092915050565b5f819050919050565b61135781611345565b8114611361575f5ffd5b50565b5f813590506113728161134e565b92915050565b5f5f5f6060848603121561138f5761138e6111d6565b5b5f84013567ffffffffffffffff8111156113ac576113ab6111da565b5b6113b886828701611326565b93505060206113c9868287016111fd565b92505060406113da86828701611364565b9150509250925092565b6113ed81611345565b82525050565b5f6020820190506114065f8301846113e4565b92915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6114358261140c565b9050919050565b6114458161142b565b811461144f575f5ffd5b50565b5f813590506114608161143c565b92915050565b5f5f6040838503121561147c5761147b6111d6565b5b5f61148985828601611452565b925050602061149a85828601611364565b9150509250929050565b5f5f83601f8401126114b9576114b8611211565b5b8235905067ffffffffffffffff8111156114d6576114d5611215565b5b6020830191508360208202830111156114f2576114f1611219565b5b9250929050565b5f5f6020838503121561150f5761150e6111d6565b5b5f83013567ffffffffffffffff81111561152c5761152b6111da565b5b611538858286016114a4565b92509250509250929050565b5f819050919050565b5f61156761156261155d8461140c565b611544565b61140c565b9050919050565b5f6115788261154d565b9050919050565b5f6115898261156e565b9050919050565b6115998161157f565b82525050565b5f6020820190506115b25f830184611590565b92915050565b5f602082840312156115cd576115cc6111d6565b5b5f6115da84828501611452565b91505092915050565b5f5f5f5f606085870312156115fb576115fa6111d6565b5b5f61160887828801611452565b945050602061161987828801611364565b935050604085013567ffffffffffffffff81111561163a576116396111da565b5b6116468782880161121d565b925092505092959194509250565b5f8115159050919050565b61166881611654565b82525050565b5f6020820190506116815f83018461165f565b92915050565b5f5ffd5b5f5ffd5b5f5f858511156116a2576116a1611687565b5b838611156116b3576116b261168b565b5b6001850283019150848603905094509492505050565b5f82905092915050565b5f82821b905092915050565b5f6116ea83836116c9565b826116f581356111de565b92506020821015611735576117307fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff836020036008026116d3565b831692505b505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b611773816111de565b82525050565b5f60ff82169050919050565b61178e81611779565b82525050565b5f6080820190506117a75f83018761176a565b6117b46020830186611785565b6117c1604083018561176a565b6117ce606083018461176a565b95945050505050565b5f82825260208201905092915050565b7f496e76616c6964207369676e6174757265206c656e67746800000000000000005f82015250565b5f61181b6018836117d7565b9150611826826117e7565b602082019050919050565b5f6020820190508181035f8301526118488161180f565b9050919050565b5f5f60408385031215611865576118646111d6565b5b5f61187285828601611364565b925050602061188385828601611364565b9150509250929050565b7f4f6e6c792073656c6600000000000000000000000000000000000000000000005f82015250565b5f6118c16009836117d7565b91506118cc8261188d565b602082019050919050565b5f6020820190508181035f8301526118ee816118b5565b9050919050565b5f5ffd5b5f5ffd5b5f5ffd5b5f8235600160600383360303811261191c5761191b6118f5565b5b80830191505092915050565b5f5f83356001602003843603038112611944576119436118f5565b5b80840192508235915067ffffffffffffffff821115611966576119656118f9565b5b602083019250600182023603831315611982576119816118fd565b5b509250929050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f6119cc8261198a565b6119d68185611994565b93506119e68185602086016119a4565b6119ef816119b2565b840191505092915050565b5f604082019050611a0d5f8301856113e4565b8181036020830152611a1f81846119c2565b90509392505050565b5f611a3383836116c9565b82611a3e81356112cf565b92506004821015611a7e57611a797fffffffff00000000000000000000000000000000000000000000000000000000836004036008026116d3565b831692505b505092915050565b5f60208284031215611a9b57611a9a6111d6565b5b5f611aa884828501611364565b91505092915050565b5f81905092915050565b828183375f83830152505050565b5f611ad48385611ab1565b9350611ae1838584611abb565b82840190509392505050565b5f611af9828486611ac9565b91508190509392505050565b611b0e8161142b565b82525050565b5f819050919050565b5f77ffffffffffffffffffffffffffffffffffffffffffffffff82169050919050565b5f611b5a611b55611b5084611b14565b611544565b611b1d565b9050919050565b611b6a81611b40565b82525050565b5f604082019050611b835f830185611b05565b611b906020830184611b61565b9392505050565b5f81519050611ba58161134e565b92915050565b5f60208284031215611bc057611bbf6111d6565b5b5f611bcd84828501611b97565b91505092915050565b5f819050919050565b611bf0611beb826111de565b611bd6565b82525050565b5f611c018284611bdf565b60208201915081905092915050565b5f611c1a8261198a565b611c248185611ab1565b9350611c348185602086016119a4565b80840191505092915050565b5f611c4b8284611c10565b915081905092915050565b5f81519050611c64816111e7565b92915050565b5f60208284031215611c7f57611c7e6111d6565b5b5f611c8c84828501611c56565b91505092915050565b5f60a082019050611ca85f83018861176a565b611cb560208301876113e4565b611cc260408301866113e4565b611ccf60608301856113e4565b611cdc60808301846113e4565b9695505050505050565b5f606082019050611cf95f830186611b05565b611d066020830185611b05565b611d136040830184611b05565b949350505050565b50565b5f611d295f83611ab1565b9150611d3482611d1b565b5f82019050919050565b5f611d4882611d1e565b9150819050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f611d8982611345565b9150611d9483611345565b9250828201905080821115611dac57611dab611d52565b5b92915050565b7f4461696c79206c696d69742065786365656465640000000000000000000000005f82015250565b5f611de66014836117d7565b9150611df182611db2565b602082019050919050565b5f6020820190508181035f830152611e1381611dda565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f611e5182611345565b9150611e5c83611345565b925082611e6c57611e6b611e1a565b5b82820490509291505056fea26469706673582212207b375be6f1fdf919f4e215b3d387c1f7a50e50de67c0c10b730617ca790a6e8b64736f6c634300081c0033"
}
